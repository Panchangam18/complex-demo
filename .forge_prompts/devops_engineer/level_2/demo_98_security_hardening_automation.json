{
  "task_description": "Execute comprehensive security hardening across the multi-cloud infrastructure using the security-hardening.sh script. Enable CloudTrail, GuardDuty, and Config in AWS, configure Security Command Center in GCP, enable Azure Defender, implement Kubernetes security with OPA Gatekeeper and Pod Security Standards, configure network security with VPC Flow Logs and Cloud Armor, set up secrets management with Vault integration, enable compliance monitoring, and implement automated security scanning with Trivy.",
  "goal": "Harden security across all cloud platforms with automated compliance and monitoring",
  "difficulty": "expert",
  "expected_actions": [
    "Run scripts/security-hardening.sh for baseline hardening",
    "Enable AWS CloudTrail in all regions with log validation",
    "Configure GuardDuty with threat intelligence feeds",
    "Set up AWS Config with security compliance rules",
    "Enable GCP Security Command Center and Binary Authorization",
    "Configure Azure Defender and Policy assignments",
    "Deploy OPA Gatekeeper with security policies",
    "Implement Pod Security Standards on all namespaces"
  ],
  "expected_outputs": [
    "CloudTrail logging all API calls with encryption",
    "GuardDuty detecting threats across regions",
    "Config rules monitoring compliance status",
    "Security Command Center showing GCP findings",
    "Azure Defender protecting AKS workloads",
    "OPA policies enforcing security constraints",
    "Network flow logs enabled for all VPCs/VNets",
    "Trivy scanning container images automatically"
  ],
  "evaluation_criteria": [
    "All cloud audit logs are encrypted and retained",
    "Threat detection services are active and alerting",
    "Compliance rules show high adherence percentage",
    "No high-severity security findings unresolved",
    "Pod security blocks privileged containers",
    "Secrets are encrypted at rest and in transit",
    "Security scans run on every deployment"
  ],
  "tags": ["security", "hardening", "compliance", "cloudtrail", "guardduty", "opa", "vault"],
  "hints": [
    "Review scripts/security-hardening.sh for all hardening steps",
    "Use --dry-run flag first to preview changes",
    "Check AWS Config rules for CIS compliance",
    "Configure Gatekeeper constraint templates carefully",
    "Enable VPC Flow Logs for network analysis"
  ],
  "files_to_modify": [
    "k8s/base/opa-gatekeeper/policies/security-policies.yaml",
    "terraform/modules/aws/security/guardduty.tf",
    "scripts/security-hardening.sh"
  ],
  "related_files": [
    "scripts/security-hardening.sh",
    "k8s/base/opa-gatekeeper/constraint-templates/",
    "terraform/modules/aws/security/"
  ]
}